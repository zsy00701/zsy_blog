---
title: 处理器架构
date: '2025-12-27T00:11:36.048Z'
excerpt: CPU 性能因素、流水线与数据通路设计
category: 计算机系统原理
---
# Processor

## Introduction

- CPU performance factors
  - Instruction count
    - Determined by ISA and compiler
  - CPI and Cycle time
    - determine by CPU hardware

## Instruction Execution（数据怎么流动）

- PC -> instruction memory,fetch instruction

> Program Counter ：存放当前指令的地址
>
> Instruction Memory:
>
> 指令存储器
>
> 输入：PC 给的地址
>
> 输出：一整条 32-bit 的指令 

- Register numbers -> register file (Read registers)

- Depending on instruction class 
  - Use ALU to calculate
    - Arithemetic result
    - Memory address for load/store
    - Branch target

## 处理器执行一条指令的过程

1. 取指（IF,Instruction Fetch)
2. 译码和读寄存器（ID，Instruction Decode）
3. 执行（EX，execuation）
4. 访存（MEM）
5. 写回（WB）

![image-20251230220531918](https://raw.githubusercontent.com/zsy00701/typora-images/main/image-20251230220531918.png)

## MultiPlexers（MUX）

在数字电路中，如果两条线直接连接（图中红色箭头所示），而一条线输出高电平（1），另一条线输出低电平（0），就会发生**信号冲突（短路）**，导致硬件损坏或逻辑错误。

为了解决冲突，我们需要一个“开关”来决定在特定时刻使用哪一条线路的数据。这就是 **Multiplexer (MUX)**。

![image-20251230220930770](https://raw.githubusercontent.com/zsy00701/typora-images/main/image-20251230220930770.png)

图中红圈对应的三个关键决策点：

1. **PC 的来源选择（左上红圈）**：
   - **情况 A**：正常顺序执行，选择 $PC + 4$。
   - **情况 B**：执行跳转指令（if/else, loop），选择计算出的跳转目标地址。
   - **MUX 作用**：根据控制信号决定 PC 下一步跳到哪里。
2. **ALU 第二个操作数的来源（中间红圈）**：
   - **情况 A**：两个寄存器相加（如 `add $t0, $t1, $t2`）。
   - **情况 B**：寄存器加一个常数（立即数）（如 `addi $t0, $t1, 100`）。
   - **MUX 作用**：决定把寄存器输出的数据还是指令中的立即数送入 ALU。
3. **写回寄存器的数据来源（右下红圈）**：
   - **情况 A**：算术运算的结果（来自 ALU）。
   - **情况 B**：从内存读取的数据（来自 Data Memory，如 `lw` 指令）。
   - **MUX 作用**：决定最后存入寄存器的是计算结果还是内存数据。

## Logic Design Basics

**Information encoded in binary:**

- Low voltage=0,High voltage=1
- One wire per bit(单根导线只能传输1bit)
- Multi-bit data encoded on multi-wire buses(总线)

**Combinational Elements（组合逻辑元件）：**

- operate on data
- output is a function of input
- **特点**：输出**仅**取决于当前的输入，没有“记忆”功能。就像数学函数 $y = f(x)$。

- **CPU 中的例子**：
  - **ALU (算术逻辑单元)**：输入两个数，立即输出和。
  - **Add (加法器)**：只管做加法。
  - **MUX (多路复用器)**：根据控制信号切换通道。

![image-20251230222230568](https://raw.githubusercontent.com/zsy00701/typora-images/main/image-20251230222230568.png)

**State(sequential) elements：**

- Store information

- **特点**：能够**存储信息**，输出不仅取决于输入，还取决于“过去的状态”。通常由时钟信号（Clock）触发。

- **CPU 中的例子**：
  - **PC (程序计数器)**：记住当前执行到哪一行。
  - **Registers (寄存器堆)**：保存计算的中间结果。
  - **Memory (存储器)**：保存程序和数据。

![image-20251230224550214](https://raw.githubusercontent.com/zsy00701/typora-images/main/image-20251230224550214.png)

![image-20251230224847097](https://raw.githubusercontent.com/zsy00701/typora-images/main/image-20251230224847097.png)
