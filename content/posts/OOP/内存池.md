---
title: 内存池与 STL 分配器
date: '2026-01-01T10:46:33.225Z'
excerpt: 高效内存管理技术与 C++ STL Allocator 实现
category: OOP
---
# STL Allocator + Memory Pool

## Core Concept

### 什么是内存池

内存池是一种内存管理技术，核心思想是：

- 🎯 预先分配：一次性从系统申请一大块内存

- 📦 切分管理：将大块切分成固定大小的小块

- ♻️ 重复使用：释放的内存不还给系统，而是放回池中重用

**为什么需要内存池：**

~~~text
传统malloc/free的问题：
1. 每次调用都是系统调用 → 慢
2. 频繁分配释放 → 产生内存碎片
3. 小对象分配效率低 → 开销大

内存池的优势：
1. 减少系统调用 → 快
2. 固定大小分配 → 无外部碎片
3. 批量管理 → 效率高
~~~

### STL Allocator

STL容器（如vector、list）使用分配器来管理内存：

~~~cpp
// STL容器的第二个模板参数就是分配器
template<class T, class Alloc = allocator<T>>
class vector;

// 使用自定义分配器
std::vector<int, PoolAllocator<int>> my_vec;
~~~

分配器的职责：

- 分配内存（allocate）

- 释放内存（deallocate）

- 构造对象（construct）

- 析构对象（destroy）

## 内存池实现

